<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Apomixis & Polyembryony Learning Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .tab-btn.active {
            background: #3498db;
            color: white;
        }

        .content-section {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .visual-container {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .diagram {
            flex: 1;
            min-width: 300px;
            height: 400px;
            border: 2px solid #ddd;
            border-radius: 15px;
            position: relative;
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            overflow: hidden;
        }

        .info-panel {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #3498db;
        }

        .interactive-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #dee2e6;
        }

        .btn {
            background: #3498db;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .simulation-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .slider-container {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .slider {
            width: 150px;
            height: 5px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
        }

        .seed {
            width: 80px;
            height: 120px;
            background: #8B4513;
            border-radius: 40px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #654321;
            margin: 10px;
        }

        .seed:hover {
            transform: scale(1.1);
        }

        .embryo-inside {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #27ae60;
            border-radius: 50%;
            border: 1px solid #1e8449;
        }

        .seed-visualization {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .comparison-table th {
            background: #3498db;
            color: white;
            padding: 15px;
            text-align: left;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        .comparison-table tr:hover {
            background: #f8f9fa;
        }

        .highlight-box {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            width: 0%;
            transition: width 0.5s ease;
        }

        .embryo-counter {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            margin: 15px 0;
        }

        .quiz-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            min-height: 300px;
        }

        .question {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .options {
            display: grid;
            gap: 10px;
            margin-bottom: 15px;
        }

        .option {
            padding: 12px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: #e9ecef;
            border-color: #3498db;
        }

        .option.selected {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }

        .option.correct {
            background: #27ae60;
            color: white;
            border-color: #229954;
        }

        .option.incorrect {
            background: #e74c3c;
            color: white;
            border-color: #c0392b;
        }

        @media (max-width: 768px) {
            .visual-container {
                flex-direction: column;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .simulation-controls {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌸 Sexual Reproduction in Angiosperms</h1>
            <p>Complete Interactive Learning Tool for Apomixis & Polyembryony</p>
            <div class="progress-bar">
                <div class="progress-fill" id="overallProgress"></div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('overview')">🌻 Overview</button>
            <button class="tab-btn" onclick="showTab('structure')">🔬 Flower Structure</button>
            <button class="tab-btn" onclick="showTab('apomixis')">🧬 Apomixis</button>
            <button class="tab-btn" onclick="showTab('polyembryony')">👥 Polyembryony</button>
            <button class="tab-btn" onclick="showTab('quiz')">🎯 Quiz</button>
        </div>

        <!-- Overview Section -->
        <div id="overview" class="content-section active">
            <h2>🌱 Sexual Reproduction in Angiosperms</h2>
            
            <div class="info-panel">
                <h3>Key Concepts</h3>
                <p><strong>Flowers</strong> are the reproductive organs of angiosperms (flowering plants). They contain both male and female reproductive structures that work together to produce seeds.</p>
            </div>

            <div class="highlight-box">
                <h3>🎯 Learning Objectives</h3>
                <p>By the end of this session, you'll understand flower structure, pollination, fertilization, apomixis, and polyembryony!</p>
            </div>

            <div class="interactive-section">
                <h3>📚 What You'll Learn</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: white; padding: 20px; border-radius: 10px; border-left: 5px solid #e74c3c;">
                        <h4>🌸 Flower Structure</h4>
                        <p>Explore the anatomy of flowers including anthers, stigma, ovary, and their functions in reproduction.</p>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 10px; border-left: 5px solid #27ae60;">
                        <h4>🧬 Apomixis</h4>
                        <p>Learn about asexual reproduction that produces seeds without fertilization - nature's cloning mechanism.</p>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 10px; border-left: 5px solid #9b59b6;">
                        <h4>👥 Polyembryony</h4>
                        <p>Discover how some seeds contain multiple embryos and their importance in agriculture.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Flower Structure Section -->
        <div id="structure" class="content-section">
            <h2>🔬 Detailed Flower Structure</h2>
            
            <div class="interactive-section">
                <h3>Flower Anatomy Diagram</h3>
                <div class="visual-container">
                    <div class="diagram" style="background: linear-gradient(135deg, #e8f5e8, #f0f8f0); text-align: center; padding: 30px;">
                        <div style="position: relative; width: 300px; height: 400px; margin: 0 auto; background: radial-gradient(circle, #ffffff, #f8f9fa); border-radius: 20px; border: 2px solid #dee2e6;">
                            <h4 style="margin: 10px 0; color: #2c3e50;">Complete Flower Structure</h4>
                            <div style="position: absolute; top: 60px; left: 50%; transform: translateX(-50%); width: 200px; height: 300px;">
                                <div style="position: absolute; top: 20px; left: 60px; width: 35px; height: 15px; background: #e74c3c; border-radius: 8px; border: 1px solid #c0392b;"></div>
                                <div style="position: absolute; top: 20px; right: 60px; width: 35px; height: 15px; background: #e74c3c; border-radius: 8px; border: 1px solid #c0392b;"></div>
                                <div style="position: absolute; top: 5px; left: 40px; font-size: 12px; font-weight: bold; color: #2c3e50;">Anthers</div>
                                <div style="position: absolute; top: 35px; left: 75px; width: 2px; height: 40px; background: #27ae60;"></div>
                                <div style="position: absolute; top: 35px; right: 75px; width: 2px; height: 40px; background: #27ae60;"></div>
                                <div style="position: absolute; top: 75px; left: 87px; width: 25px; height: 25px; background: #2ecc71; border-radius: 50%; border: 1px solid #27ae60;"></div>
                                <div style="position: absolute; top: 60px; right: 30px; font-size: 12px; font-weight: bold; color: #2c3e50;">Stigma</div>
                                <div style="position: absolute; top: 100px; left: 95px; width: 5px; height: 80px; background: linear-gradient(to bottom, #2ecc71, #27ae60); border-radius: 3px;"></div>
                                <div style="position: absolute; top: 140px; right: 10px; font-size: 10px; color: #2c3e50;">Style</div>
                                <div style="position: absolute; bottom: 80px; left: 75px; width: 50px; height: 35px; background: #9b59b6; border-radius: 25px; border: 1px solid #8e44ad;"></div>
                                <div style="position: absolute; bottom: 110px; left: 130px; font-size: 12px; font-weight: bold; color: #2c3e50;">Ovary</div>
                                <div style="position: absolute; bottom: 90px; left: 85px; width: 6px; height: 6px; background: #f39c12; border-radius: 50%;"></div>
                                <div style="position: absolute; bottom: 85px; left: 95px; width: 6px; height: 6px; background: #f39c12; border-radius: 50%;"></div>
                                <div style="position: absolute; bottom: 90px; left: 105px; width: 6px; height: 6px; background: #f39c12; border-radius: 50%;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="info-panel">
                        <h3>🌸 Flower Structure Components</h3>
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Part</th>
                                    <th>Function</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong style="color: #e74c3c;">Anther</strong></td>
                                    <td>Produces pollen grains</td>
                                    <td>Male reproductive organ, bilobed and dithecous</td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #2ecc71;">Stigma</strong></td>
                                    <td>Receives pollen</td>
                                    <td>Sticky surface for pollen adhesion</td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #27ae60;">Style</strong></td>
                                    <td>Connects stigma to ovary</td>
                                    <td>Pathway for pollen tube growth</td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #9b59b6;">Ovary</strong></td>
                                    <td>Contains ovules</td>
                                    <td>Female reproductive organ, develops into fruit</td>
                                </tr>
                                <tr>
                                    <td><strong style="color: #f39c12;">Ovules</strong></td>
                                    <td>Develop into seeds</td>
                                    <td>Contain embryo sacs with female gametes</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Apomixis Section -->
        <div id="apomixis" class="content-section">
            <h2>🧬 Apomixis - Asexual Reproduction</h2>
            
            <div class="info-panel">
                <h3>What is Apomixis?</h3>
                <p>Apomixis is a form of <strong>asexual reproduction</strong> that mimics sexual reproduction, producing seeds <strong>without fertilization</strong>.</p>
            </div>

            <div class="interactive-section">
                <h3>Types of Apomictic Development</h3>
                <div class="simulation-controls">
                    <button class="btn" onclick="showApomixisType('diploid')">Diploid Egg Development</button>
                    <button class="btn" onclick="showApomixisType('nucellar')">Nucellar Embryony</button>
                </div>
                
                <div id="apomixisVisualization" class="diagram">
                    <div style="text-align: center; padding: 50px; color: #7f8c8d;">
                        Click buttons above to see different types of apomictic development
                    </div>
                </div>
            </div>

            <div class="interactive-section">
                <h3>🧪 Virtual Orange Seed Experiment</h3>
                <p>Squeeze virtual orange seeds to observe multiple embryos!</p>
                <div class="seed-visualization" id="orangeSeeds">
                    <!-- Seeds will be generated dynamically -->
                </div>
                <button class="btn" onclick="generateOrangeSeeds()">🍊 Generate New Seeds</button>
                <div class="embryo-counter" id="embryoCount">
                    Click on seeds to count embryos!
                </div>
            </div>
        </div>

        <!-- Polyembryony Section -->
        <div id="polyembryony" class="content-section">
            <h2>👥 Polyembryony - Multiple Embryos</h2>
            
            <div class="info-panel">
                <h3>Understanding Polyembryony</h3>
                <p><strong>Polyembryony</strong> is the occurrence of more than one embryo in a single seed. This is common in apomictic plants.</p>
            </div>

            <div class="interactive-section">
                <h3>Embryo Development Simulator</h3>
                <div class="simulation-controls">
                    <div class="slider-container">
                        <label>Number of Embryos:</label>
                        <input type="range" class="slider" id="embryoSlider" min="1" max="8" value="3" oninput="updateEmbryoCount()">
                        <span id="embryoNumber">3</span>
                    </div>
                    <button class="btn" onclick="animateEmbryoDevelopment()">▶️ Animate Development</button>
                </div>
                
                <div class="seed-visualization" style="justify-content: center; margin: 30px 0;">
                    <div style="position: relative;">
                        <div id="polyembryonicSeed" style="position: relative; width: 160px; height: 240px; background: linear-gradient(145deg, #8B4513, #A0522D); border-radius: 80px; margin: 0 auto; border: 3px solid #654321; box-shadow: 0 8px 16px rgba(0,0,0,0.3);">
                            <div id="embryoContainer" style="position: absolute; top: 30px; left: 20px; right: 20px; bottom: 30px;">
                                <!-- Embryos will be dynamically generated here -->
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 15px;">
                            <div style="font-weight: bold; color: #2c3e50;">Polyembryonic Seed</div>
                        </div>
                    </div>
                </div>
            </div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Aspect</th>
                        <th>Normal Seeds</th>
                        <th>Polyembryonic Seeds</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Number of Embryos</td>
                        <td>1</td>
                        <td>2-8 (or more)</td>
                    </tr>
                    <tr>
                        <td>Genetic Nature</td>
                        <td>Sexually produced</td>
                        <td>Mostly clones (apomictic)</td>
                    </tr>
                    <tr>
                        <td>Size Variation</td>
                        <td>Uniform</td>
                        <td>Different sizes</td>
                    </tr>
                    <tr>
                        <td>Origin</td>
                        <td>Fertilized egg</td>
                        <td>Nucellar cells or unfertilized egg</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Quiz Section -->
        <div id="quiz" class="content-section">
            <h2>🎯 Test Your Knowledge</h2>
            
            <div class="quiz-container" id="quizContainer">
                <div style="text-align: center; padding: 40px; color: #7f8c8d;">
                    <div style="font-size: 3em; margin-bottom: 20px;">🎯</div>
                    <div style="font-size: 1.2em;">Click "Start Quiz" to begin!</div>
                </div>
            </div>
            
            <div class="simulation-controls">
                <button class="btn" onclick="initializeQuiz()">🚀 Start Quiz</button>
                <button class="btn" onclick="previousQuestion()" id="prevBtn" disabled style="display: none;">⬅️ Previous</button>
                <button class="btn" onclick="nextQuestion()" id="nextBtn" style="display: none;">Next ➡️</button>
                <button class="btn" onclick="submitQuiz()" id="submitBtn" style="display: none;">🎉 Submit Quiz</button>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="quizProgress"></div>
            </div>
            
            <div id="quizResults" style="display: none;" class="highlight-box">
                <!-- Results will be shown here -->
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentTab = 'overview';
        let currentQuizQuestion = 0;
        let quizAnswers = [];
        let embryoCount = 3;
        let quizStarted = false;
        
        // Quiz questions data
        const quizQuestions = [
            {
                question: "What is apomixis?",
                options: [
                    "Sexual reproduction with double fertilization",
                    "Asexual reproduction that produces seeds without fertilization",
                    "Formation of multiple flowers on one plant",
                    "Process of pollen grain formation"
                ],
                correct: 1,
                explanation: "Apomixis is a form of asexual reproduction that mimics sexual reproduction but produces seeds without fertilization."
            },
            {
                question: "Which plants commonly show polyembryony?",
                options: [
                    "Roses and jasmine",
                    "Citrus and mango",
                    "Rice and wheat",
                    "Potato and tomato"
                ],
                correct: 1,
                explanation: "Citrus fruits like oranges and mangoes commonly show polyembryony with multiple embryos per seed."
            },
            {
                question: "What is the main advantage of apomixis in agriculture?",
                options: [
                    "Produces more colorful flowers",
                    "Increases seed size",
                    "Maintains hybrid characteristics without segregation",
                    "Reduces plant height"
                ],
                correct: 2,
                explanation: "Apomixis helps maintain hybrid characteristics in successive generations without genetic segregation."
            },
            {
                question: "In nucellar embryony, embryos develop from:",
                options: [
                    "Fertilized egg cell",
                    "Pollen grains",
                    "Nucellar cells surrounding the embryo sac",
                    "Antipodal cells"
                ],
                correct: 2,
                explanation: "In nucellar embryony, some nucellar cells around the embryo sac divide and develop into embryos."
            },
            {
                question: "Polyembryonic seeds contain:",
                options: [
                    "Only one embryo",
                    "No embryos",
                    "Multiple embryos of same size",
                    "Multiple embryos of different sizes"
                ],
                correct: 3,
                explanation: "Polyembryonic seeds contain multiple embryos that are typically of different sizes and shapes."
            }
        ];

        // Tab switching function
        function showTab(tabName) {
            try {
                // Hide all sections
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Remove active class from all tabs
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Show selected section and activate tab
                const selectedSection = document.getElementById(tabName);
                if (selectedSection) {
                    selectedSection.classList.add('active');
                }
                
                // Find and activate the clicked tab
                const tabs = document.querySelectorAll('.tab-btn');
                tabs.forEach(tab => {
                    if (tab.textContent.includes(getTabDisplayName(tabName))) {
                        tab.classList.add('active');
                    }
                });
                
                currentTab = tabName;
                updateProgress();
                
                // Initialize specific tab content
                if (tabName === 'polyembryony') {
                    setTimeout(() => updateEmbryoCount(), 100);
                } else if (tabName === 'apomixis') {
                    setTimeout(() => generateOrangeSeeds(), 100);
                }
            } catch (error) {
                console.error('Error in showTab:', error);
            }
        }

        function getTabDisplayName(tabName) {
            const tabNames = {
                'overview': 'Overview',
                'structure': 'Flower Structure',
                'apomixis': 'Apomixis',
                'polyembryony': 'Polyembryony',
                'quiz': 'Quiz'
            };
            return tabNames[tabName] || tabName;
        }

        // Show apomixis types
        function showApomixisType(type) {
            try {
                const container = document.getElementById('apomixisVisualization');
                if (!container) return;
                
                let content = '';
                
                if (type === 'diploid') {
                    content = `
                        <div style="text-align: center; padding: 20px;">
                            <h3>🧬 Diploid Egg Development</h3>
                            <div style="display: flex; justify-content: center; align-items: center; gap: 20px; margin: 20px 0;">
                                <div style="width: 60px; height: 60px; background: #e74c3c; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">2n</div>
                                <div style="font-size: 2em;">→</div>
                                <div style="width: 80px; height: 60px; background: #27ae60; border-radius: 30px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">Embryo</div>
                            </div>
                            <p><strong>Process:</strong> Diploid egg cell develops without fertilization</p>
                            <p><strong>Result:</strong> Genetically identical offspring (clones)</p>
                        </div>
                    `;
                } else if (type === 'nucellar') {
                    content = `
                        <div style="text-align: center; padding: 20px;">
                            <h3>🌱 Nucellar Embryony</h3>
                            <div style="display: flex; justify-content: center; gap: 10px; margin: 20px 0;">
                                <div style="width: 40px; height: 40px; background: #9b59b6; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.8em;">NC</div>
                                <div style="width: 40px; height: 40px; background: #9b59b6; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.8em;">NC</div>
                                <div style="font-size: 1.5em; align-self: center;">→</div>
                                <div style="width: 40px; height: 30px; background: #27ae60; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7em;">E1</div>
                                <div style="width: 40px; height: 30px; background: #27ae60; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7em;">E2</div>
                            </div>
                            <p><strong>NC:</strong> Nucellar Cells, <strong>E:</strong> Embryos</p>
                            <p><strong>Process:</strong> Nucellar cells divide and form multiple embryos</p>
                            <p><strong>Common in:</strong> Citrus, Mango</p>
                        </div>
                    `;
                }
                
                container.innerHTML = content;
            } catch (error) {
                console.error('Error in showApomixisType:', error);
            }
        }

        // Generate orange seeds for experiment
        function generateOrangeSeeds() {
            try {
                const container = document.getElementById('orangeSeeds');
                if (!container) return;
                
                container.innerHTML = '';
                
                for (let i = 0; i < 5; i++) {
                    const seed = document.createElement('div');
                    seed.className = 'seed';
                    seed.dataset.embryos = Math.floor(Math.random() * 6) + 2;
                    seed.onclick = () => squeezeSeed(seed);
                    seed.style.cursor = 'pointer';
                    seed.title = 'Click to squeeze and reveal embryos!';
                    
                    container.appendChild(seed);
                }
                
                const embryoCountEl = document.getElementById('embryoCount');
                if (embryoCountEl) {
                    embryoCountEl.innerHTML = 'Click on seeds to count embryos!';
                }
            } catch (error) {
                console.error('Error in generateOrangeSeeds:', error);
            }
        }

        // Squeeze seed to show embryos
        function squeezeSeed(seed) {
            try {
                const embryoCount = parseInt(seed.dataset.embryos);
                seed.innerHTML = '';
                
                for (let i = 0; i < embryoCount; i++) {
                    const embryo = document.createElement('div');
                    embryo.className = 'embryo-inside';
                    embryo.style.left = Math.random() * 60 + 10 + 'px';
                    embryo.style.top = Math.random() * 100 + 10 + 'px';
                    seed.appendChild(embryo);
                }
                
                const embryoCountEl = document.getElementById('embryoCount');
                if (embryoCountEl) {
                    embryoCountEl.innerHTML = `
                        <strong>Embryos found: ${embryoCount}</strong><br>
                        Different sizes indicate different developmental stages
                    `;
                }
            } catch (error) {
                console.error('Error in squeezeSeed:', error);
            }
        }

        // Update embryo count in polyembryony section
        function updateEmbryoCount() {
            try {
                const slider = document.getElementById('embryoSlider');
                const display = document.getElementById('embryoNumber');
                const container = document.getElementById('embryoContainer');
                
                if (!slider || !display || !container) return;
                
                embryoCount = parseInt(slider.value);
                display.textContent = embryoCount;
                
                container.innerHTML = '';
                
                const colors = ['#27ae60', '#2ecc71', '#3498db', '#e74c3c', '#f39c12', '#9b59b6', '#1abc9c', '#e67e22'];
                
                for (let i = 0; i < embryoCount; i++) {
                    const embryo = document.createElement('div');
                    const size = Math.max(8, 16 - i * 1.5);
                    
                    embryo.style.position = 'absolute';
                    embryo.style.width = size + 'px';
                    embryo.style.height = size + 'px';
                    embryo.style.background = colors[i % colors.length];
                    embryo.style.borderRadius = '50%';
                    embryo.style.border = '1px solid rgba(255,255,255,0.3)';
                    embryo.style.boxShadow = '0 2px 4px rgba(0,0,0,0.2)';
                    embryo.style.left = Math.random() * (120 - size) + 'px';
                    embryo.style.top = Math.random() * (180 - size) + 'px';
                    embryo.style.transition = 'all 0.3s ease';
                    
                    container.appendChild(embryo);
                }
            } catch (error) {
                console.error('Error in updateEmbryoCount:', error);
            }
        }

        // Animate embryo development
        function animateEmbryoDevelopment() {
            try {
                const embryos = document.querySelectorAll('#embryoContainer > div');
                embryos.forEach((embryo, index) => {
                    setTimeout(() => {
                        embryo.style.background = '#e74c3c';
                        embryo.style.transform = 'scale(1.3)';
                        setTimeout(() => {
                            embryo.style.background = '#27ae60';
                            embryo.style.transform = 'scale(1)';
                        }, 500);
                    }, index * 200);
                });
            } catch (error) {
                console.error('Error in animateEmbryoDevelopment:', error);
            }
        }

        // Quiz functions
        function initializeQuiz() {
            try {
                currentQuizQuestion = 0;
                quizAnswers = new Array(quizQuestions.length).fill(null);
                quizStarted = true;
                
                // Show quiz controls
                document.getElementById('prevBtn').style.display = 'inline-block';
                document.getElementById('nextBtn').style.display = 'inline-block';
                
                // Hide quiz results
                const resultsContainer = document.getElementById('quizResults');
                if (resultsContainer) {
                    resultsContainer.style.display = 'none';
                }
                
                showQuizQuestion();
                updateQuizProgress();
                
                console.log('Quiz initialized successfully');
            } catch (error) {
                console.error('Error in initializeQuiz:', error);
                
                // Fallback - show at least something
                const container = document.getElementById('quizContainer');
                if (container) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #e74c3c;">
                            <h3>⚠️ Error Loading Quiz</h3>
                            <p>There was an error loading the quiz. Please refresh the page and try again.</p>
                        </div>
                    `;
                }
            }
        }

        function showQuizQuestion() {
            try {
                const container = document.getElementById('quizContainer');
                if (!container || !quizQuestions[currentQuizQuestion]) {
                    console.error('Quiz container or question not found');
                    return;
                }
                
                const question = quizQuestions[currentQuizQuestion];
                
                container.innerHTML = `
                    <div class="question">
                        Question ${currentQuizQuestion + 1} of ${quizQuestions.length}: ${question.question}
                    </div>
                    <div class="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectAnswer(${index})" data-index="${index}">
                                ${String.fromCharCode(65 + index)}. ${option}
                            </div>
                        `).join('')}
                    </div>
                    <div id="explanation" style="display: none; background: #e8f4f8; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>💡 Explanation:</strong> ${question.explanation}
                    </div>
                `;
                
                // Restore previous answer if exists
                if (quizAnswers[currentQuizQuestion] !== null) {
                    const selectedOption = container.querySelector(`[data-index="${quizAnswers[currentQuizQuestion]}"]`);
                    if (selectedOption) {
                        selectedOption.classList.add('selected');
                        document.getElementById('explanation').style.display = 'block';
                    }
                }
                
                // Update navigation buttons
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                const submitBtn = document.getElementById('submitBtn');
                
                if (prevBtn) prevBtn.disabled = currentQuizQuestion === 0;
                if (nextBtn) nextBtn.style.display = currentQuizQuestion === quizQuestions.length - 1 ? 'none' : 'inline-block';
                if (submitBtn) submitBtn.style.display = currentQuizQuestion === quizQuestions.length - 1 ? 'inline-block' : 'none';
                
                console.log(`Showing question ${currentQuizQuestion + 1}`);
            } catch (error) {
                console.error('Error in showQuizQuestion:', error);
            }
        }

        function selectAnswer(answerIndex) {
            try {
                // Clear previous selections
                document.querySelectorAll('.option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Mark selected answer
                const selectedOption = document.querySelector(`[data-index="${answerIndex}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                    quizAnswers[currentQuizQuestion] = answerIndex;
                    
                    // Show explanation
                    const explanation = document.getElementById('explanation');
                    if (explanation) {
                        explanation.style.display = 'block';
                    }
                    
                    console.log(`Answer ${answerIndex} selected for question ${currentQuizQuestion + 1}`);
                }
            } catch (error) {
                console.error('Error in selectAnswer:', error);
            }
        }

        function nextQuestion() {
            try {
                if (currentQuizQuestion < quizQuestions.length - 1) {
                    currentQuizQuestion++;
                    showQuizQuestion();
                    updateQuizProgress();
                }
            } catch (error) {
                console.error('Error in nextQuestion:', error);
            }
        }

        function previousQuestion() {
            try {
                if (currentQuizQuestion > 0) {
                    currentQuizQuestion--;
                    showQuizQuestion();
                    updateQuizProgress();
                }
            } catch (error) {
                console.error('Error in previousQuestion:', error);
            }
        }

        function submitQuiz() {
            try {
                let correctAnswers = 0;
                quizAnswers.forEach((answer, index) => {
                    if (answer === quizQuestions[index].correct) {
                        correctAnswers++;
                    }
                });
                
                const percentage = Math.round((correctAnswers / quizQuestions.length) * 100);
                const resultsContainer = document.getElementById('quizResults');
                
                if (!resultsContainer) return;
                
                let message = '';
                let color = '';
                
                if (percentage >= 80) {
                    message = 'Excellent! You have mastered the concepts! 🎉';
                    color = '#27ae60';
                } else if (percentage >= 60) {
                    message = 'Good job! Review the concepts once more. 👍';
                    color = '#f39c12';
                } else {
                    message = 'Keep studying! You can do better! 💪';
                    color = '#e74c3c';
                }
                
                resultsContainer.innerHTML = `
                    <h3 style="color: ${color};">🎯 Quiz Results</h3>
                    <div style="font-size: 1.5em; margin: 20px 0;">
                        Score: ${correctAnswers}/${quizQuestions.length} (${percentage}%)
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                        ${message}
                    </div>
                    <button class="btn" onclick="initializeQuiz()" style="margin-top: 15px;">🔄 Retake Quiz</button>
                `;
                
                resultsContainer.style.display = 'block';
                
                // Hide quiz container and controls
                const quizContainer = document.getElementById('quizContainer');
                const controls = document.querySelector('#quiz .simulation-controls');
                
                if (quizContainer) quizContainer.style.display = 'none';
                if (controls) controls.style.display = 'none';
                
                console.log(`Quiz submitted. Score: ${correctAnswers}/${quizQuestions.length}`);
            } catch (error) {
                console.error('Error in submitQuiz:', error);
            }
        }

        function updateQuizProgress() {
            try {
                const progress = ((currentQuizQuestion + 1) / quizQuestions.length) * 100;
                const progressBar = document.getElementById('quizProgress');
                if (progressBar) {
                    progressBar.style.width = progress + '%';
                }
            } catch (error) {
                console.error('Error in updateQuizProgress:', error);
            }
        }

        // Overall progress tracking
        function updateProgress() {
            try {
                const tabs = ['overview', 'structure', 'apomixis', 'polyembryony', 'quiz'];
                const currentIndex = tabs.indexOf(currentTab);
                const progress = ((currentIndex + 1) / tabs.length) * 100;
                
                const progressBar = document.getElementById('overallProgress');
                if (progressBar) {
                    progressBar.style.width = progress + '%';
                }
            } catch (error) {
                console.error('Error in updateProgress:', error);
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('🌱 Initializing Apomixis & Polyembryony Learning Tool...');
                
                // Initialize all sections
                generateOrangeSeeds();
                updateProgress();
                updateEmbryoCount();
                
                console.log('✅ Learning tool initialized successfully!');
                
            } catch (error) {
                console.error('Error during initialization:', error);
            }
        });

        // Global error handler
        window.addEventListener('error', function(event) {
            console.error('Global error caught:', event.error);
        });
    </script>
</body>
</html>
