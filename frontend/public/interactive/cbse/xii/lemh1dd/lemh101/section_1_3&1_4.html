<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Types of Functions Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .tab-btn.active {
            background: #3498db;
            color: white;
        }

        .content-section {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .visual-container {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .function-diagram {
            flex: 1;
            min-width: 300px;
            height: 400px;
            border: 2px solid #ddd;
            border-radius: 15px;
            position: relative;
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            overflow: hidden;
        }

        .set-container {
            position: absolute;
            width: 120px;
            height: 300px;
            border: 2px solid #3498db;
            border-radius: 60px;
            background: rgba(255, 255, 255, 0.8);
        }

        .domain {
            left: 30px;
            top: 50px;
        }

        .codomain {
            right: 30px;
            top: 50px;
        }

        .element {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            font-size: 0.9em;
        }

        .element:hover {
            transform: scale(1.15);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .element.selected {
            border: 3px solid #fff;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.8);
            transform: scale(1.2);
        }

        .domain-element {
            background: #e74c3c;
            left: 50%;
            transform: translateX(-50%);
        }

        .codomain-element {
            background: #27ae60;
            left: 50%;
            transform: translateX(-50%);
        }

        .interactive-panel {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #dee2e6;
        }

        .btn {
            background: #3498db;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn.secondary {
            background: #95a5a6;
        }

        .btn.success {
            background: #27ae60;
        }

        .btn.danger {
            background: #e74c3c;
        }

        .btn.warning {
            background: #f39c12;
        }

        .properties-panel {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .property-indicator {
            display: inline-block;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 20px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .property-indicator.true {
            background: #27ae60;
            animation: pulse 1s ease-in-out;
        }

        .property-indicator.false {
            background: #e74c3c;
        }

        .property-indicator.unknown {
            background: #95a5a6;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .definition-box {
            background: #e8f4f8;
            border-left: 5px solid #3498db;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
        }

        .examples-carousel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .step-indicator {
            background: #ecf0f1;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #3498db;
            transition: all 0.3s ease;
        }

        .step-indicator:hover {
            background: #d5dbdb;
            transform: translateX(5px);
        }

        .composition-workspace {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }

        .function-box {
            background: white;
            border: 2px solid #3498db;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            min-width: 150px;
            transition: all 0.3s ease;
        }

        .function-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .controls {
            display: flex;
            gap: 15px;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .quiz-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            min-height: 300px;
        }

        .question {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .options {
            display: grid;
            gap: 10px;
            margin-bottom: 15px;
        }

        .option {
            padding: 12px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: #e9ecef;
            border-color: #3498db;
            transform: translateX(5px);
        }

        .option.selected {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }

        .option.correct {
            background: #27ae60;
            color: white;
            border-color: #229954;
        }

        .option.incorrect {
            background: #e74c3c;
            color: white;
            border-color: #c0392b;
        }

        .highlight-box {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            width: 0%;
            transition: width 0.5s ease;
        }

        .mapping-display {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .visual-container {
                flex-direction: column;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .composition-workspace {
                flex-direction: column;
            }

            .element {
                width: 25px;
                height: 25px;
                font-size: 0.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔢 Types of Functions Interactive Tool</h1>
            <p>Explore One-One, Onto, Bijective Functions and Function Composition!</p>
            <div class="progress-bar">
                <div class="progress-fill" id="overallProgress"></div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('intro')">📚 Introduction</button>
            <button class="tab-btn" onclick="showTab('types')">🔍 Function Types</button>
            <button class="tab-btn" onclick="showTab('composition')">🔗 Composition</button>
            <button class="tab-btn" onclick="showTab('inverse')">🔄 Inverse Functions</button>
            <button class="tab-btn" onclick="showTab('examples')">💡 Examples</button>
            <button class="tab-btn" onclick="showTab('quiz')">🎯 Quiz</button>
        </div>

        <!-- Introduction Section -->
        <div id="intro" class="content-section active">
            <h2>📚 Introduction to Function Types</h2>
            
            <div class="definition-box">
                <h3>What are Function Types?</h3>
                <p>Functions can be classified based on how they map elements from domain to codomain:</p>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>One-One (Injective):</strong> Different inputs give different outputs</li>
                    <li><strong>Onto (Surjective):</strong> Every element in codomain is an output</li>
                    <li><strong>Bijective:</strong> Both one-one and onto</li>
                    <li><strong>Many-One:</strong> Some outputs have multiple inputs</li>
                </ul>
            </div>

            <div class="interactive-panel">
                <h3>🎮 Quick Function Type Demo</h3>
                <div class="controls">
                    <button class="btn" onclick="showQuickDemo('oneone')">📍 One-One Example</button>
                    <button class="btn" onclick="showQuickDemo('onto')">🎯 Onto Example</button>
                    <button class="btn" onclick="showQuickDemo('bijective')">⚡ Bijective Example</button>
                    <button class="btn" onclick="showQuickDemo('manyone')">📊 Many-One Example</button>
                </div>

                <div class="visual-container">
                    <div class="function-diagram" id="demoFunction">
                        <div style="text-align: center; padding: 80px 20px; color: #7f8c8d; font-size: 1.1em;">
                            <div style="font-size: 3em; margin-bottom: 15px;">🔢</div>
                            <div>Click buttons above to see different function types!</div>
                        </div>
                    </div>
                    
                    <div style="flex: 1;">
                        <div id="demoProperties" class="properties-panel">
                            <h3>🎯 Function Properties</h3>
                            <div class="property-indicator unknown">One-One: ?</div>
                            <div class="property-indicator unknown">Onto: ?</div>
                            <div class="property-indicator unknown">Bijective: ?</div>
                        </div>
                        
                        <div id="demoExplanation" class="definition-box">
                            <h4>Function Analysis</h4>
                            <p>Select a function type to see its properties and visual representation!</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <h3>🎯 Learning Journey</h3>
                <p>Master function types → Explore composition → Discover inverse functions → Practice with real examples!</p>
            </div>
        </div>

        <!-- Function Types Section -->
        <div id="types" class="content-section">
            <h2>🔍 Understanding Function Types</h2>
            
            <div class="interactive-panel">
                <h3>Interactive Function Type Explorer</h3>
                <div class="controls">
                    <button class="btn" onclick="loadFunctionType('f1')">f₁: One-One, Not Onto</button>
                    <button class="btn" onclick="loadFunctionType('f2')">f₂: Many-One, Not Onto</button>
                    <button class="btn" onclick="loadFunctionType('f3')">f₃: Many-One, Onto</button>
                    <button class="btn" onclick="loadFunctionType('f4')">f₄: One-One, Onto (Bijective)</button>
                </div>

                <div class="visual-container">
                    <div class="function-diagram" id="typeVisualization">
                        <div style="text-align: center; padding: 80px 20px; color: #7f8c8d;">
                            <div style="font-size: 2.5em; margin-bottom: 15px;">📊</div>
                            <div>Select a function to explore from textbook Figure 1.2</div>
                        </div>
                    </div>
                    
                    <div style="flex: 1;">
                        <div id="typeProperties" class="properties-panel">
                            <h3>📊 Current Function Properties</h3>
                            <div id="typePropertyDisplay">
                                <div class="property-indicator unknown">One-One: ?</div>
                                <div class="property-indicator unknown">Onto: ?</div>
                                <div class="property-indicator unknown">Type: ?</div>
                            </div>
                        </div>
                        
                        <div id="typeExplanation" class="definition-box">
                            <h4>Function Analysis</h4>
                            <p>Click on a function above to see detailed analysis of its properties.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="examples-carousel">
                <h3>📖 Key Definitions</h3>
                <div class="step-indicator">
                    <strong>One-One (Injective):</strong> f(x₁) = f(x₂) implies x₁ = x₂
                    <br><em>Different inputs always give different outputs</em>
                </div>
                <div class="step-indicator">
                    <strong>Onto (Surjective):</strong> For every y ∈ Y, there exists x ∈ X such that f(x) = y
                    <br><em>Every element in codomain is reached</em>
                </div>
                <div class="step-indicator">
                    <strong>Bijective:</strong> Function that is both one-one and onto
                    <br><em>Perfect one-to-one correspondence</em>
                </div>
            </div>
        </div>

        <!-- Composition Section -->
        <div id="composition" class="content-section">
            <h2>🔗 Function Composition</h2>
            
            <div class="definition-box">
                <h3>Function Composition</h3>
                <p>If f: A → B and g: B → C, then the composition gof: A → C is defined by <strong>(gof)(x) = g(f(x))</strong></p>
            </div>

            <div class="interactive-panel">
                <h3>🎪 Composition Visualizer</h3>
                <div class="controls">
                    <button class="btn" onclick="loadCompositionExample('example15')">📚 Example 15</button>
                    <button class="btn" onclick="loadCompositionExample('example16')">🔢 Example 16</button>
                    <button class="btn" onclick="createCustomComposition()">⚙️ Custom Composition</button>
                    <button class="btn secondary" onclick="showCompositionSteps()">📋 Show Steps</button>
                </div>

                <div class="composition-workspace">
                    <div class="function-box">
                        <h4>Function f</h4>
                        <div id="functionF" style="margin: 10px 0; font-family: monospace;">
                            f: A → B
                        </div>
                    </div>
                    
                    <div style="font-size: 2em; color: #3498db;">→</div>
                    
                    <div class="function-box">
                        <h4>Function g</h4>
                        <div id="functionG" style="margin: 10px 0; font-family: monospace;">
                            g: B → C
                        </div>
                    </div>
                    
                    <div style="font-size: 2em; color: #e74c3c;">=</div>
                    
                    <div class="function-box" style="border-color: #27ae60;">
                        <h4>Composition gof</h4>
                        <div id="compositionResult" style="margin: 10px 0; font-family: monospace;">
                            gof: A → C
                        </div>
                    </div>
                </div>

                <div id="compositionVisualization" class="function-diagram" style="height: 300px; margin: 20px 0;">
                    <div style="text-align: center; padding: 60px 20px; color: #7f8c8d;">
                        <div style="font-size: 2.5em; margin-bottom: 15px;">🔗</div>
                        <div>Select an example to see function composition in action!</div>
                    </div>
                </div>

                <div id="compositionSteps" class="examples-carousel" style="display: none;">
                    <h3>📋 Composition Steps</h3>
                    <div id="stepsList"></div>
                </div>
            </div>
        </div>

        <!-- Inverse Functions Section -->
        <div id="inverse" class="content-section">
            <h2>🔄 Inverse Functions</h2>
            
            <div class="definition-box">
                <h3>Invertible Functions</h3>
                <p>A function f: X → Y is <strong>invertible</strong> if there exists g: Y → X such that gof = I_X and fog = I_Y. The function g is called f⁻¹.</p>
                <p><strong>Key Fact:</strong> f is invertible ⟺ f is bijective (both one-one and onto)</p>
            </div>

            <div class="interactive-panel">
                <h3>🔍 Inverse Function Explorer</h3>
                <div class="controls">
                    <button class="btn" onclick="loadInverseExample('linear')">📈 Linear Function</button>
                    <button class="btn" onclick="loadInverseExample('quadratic')">📊 Quadratic Function</button>
                    <button class="btn" onclick="loadInverseExample('example17')">📚 Example 17</button>
                    <button class="btn secondary" onclick="testInverse()">🧪 Test Inverse</button>
                </div>

                <div class="visual-container">
                    <div class="function-diagram" id="inverseVisualization">
                        <div style="text-align: center; padding: 80px 20px; color: #7f8c8d;">
                            <div style="font-size: 2.5em; margin-bottom: 15px;">🔄</div>
                            <div>Select a function to explore its inverse!</div>
                        </div>
                    </div>
                    
                    <div style="flex: 1;">
                        <div id="inverseProperties" class="properties-panel">
                            <h3>🎯 Inverse Analysis</h3>
                            <div id="inverseStatus">
                                <div class="property-indicator unknown">Invertible: ?</div>
                                <div class="property-indicator unknown">One-One: ?</div>
                                <div class="property-indicator unknown">Onto: ?</div>
                            </div>
                        </div>
                        
                        <div id="inverseDetails" class="definition-box">
                            <h4>Inverse Function Details</h4>
                            <p>Select a function to see if it has an inverse and how to find it.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Examples Section -->
        <div id="examples" class="content-section">
            <h2>💡 Interactive Examples</h2>
            
            <div class="interactive-panel">
                <h3>🎪 Textbook Examples</h3>
                <div class="controls">
                    <button class="btn" onclick="loadTextbookExample('example7')">👥 Example 7: Student Roll Numbers</button>
                    <button class="btn" onclick="loadTextbookExample('example8')">🔢 Example 8: f(x) = 2x on ℕ</button>
                    <button class="btn" onclick="loadTextbookExample('example9')">📈 Example 9: f(x) = 2x on ℝ</button>
                    <button class="btn" onclick="loadTextbookExample('example11')">📊 Example 11: f(x) = x²</button>
                </div>

                <div id="exampleWorkspace" class="visual-container">
                    <div class="function-diagram" id="exampleVisualization">
                        <div style="text-align: center; padding: 80px 20px; color: #7f8c8d;">
                            <div style="font-size: 2.5em; margin-bottom: 15px;">💡</div>
                            <div>Select an example to explore!</div>
                        </div>
                    </div>
                    
                    <div style="flex: 1;">
                        <div id="exampleAnalysis" class="examples-carousel">
                            <h3>📖 Example Analysis</h3>
                            <div id="exampleSteps">
                                <p>Choose an example to see step-by-step analysis!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quiz Section -->
        <div id="quiz" class="content-section">
            <h2>🎯 Practice Quiz</h2>
            
            <div class="quiz-container" id="quizContainer">
                <div style="text-align: center; padding: 40px; color: #7f8c8d;">
                    <div style="font-size: 3em; margin-bottom: 20px;">🎯</div>
                    <div style="font-size: 1.2em;">Test your understanding of function types!</div>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn" onclick="startQuiz()">🚀 Start Quiz</button>
                <button class="btn" onclick="previousQuestion()" id="prevBtn" style="display: none;">⬅️ Previous</button>
                <button class="btn" onclick="nextQuestion()" id="nextBtn" style="display: none;">Next ➡️</button>
                <button class="btn success" onclick="submitQuiz()" id="submitBtn" style="display: none;">✅ Submit Quiz</button>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="quizProgress"></div>
            </div>
            
            <div id="quizResults" style="display: none;" class="highlight-box">
                <!-- Results will be shown here -->
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentTab = 'intro';
        let currentQuizQuestion = 0;
        let quizAnswers = [];
        let quizStarted = false;

        // Quiz questions
        const quizQuestions = [
            {
                question: "Which function type maps different inputs to different outputs?",
                options: [
                    "Many-one function",
                    "One-one (injective) function",
                    "Onto (surjective) function",
                    "Neither one-one nor onto"
                ],
                correct: 1,
                explanation: "One-one (injective) functions ensure that different inputs always map to different outputs."
            },
            {
                question: "For a function f: ℕ → ℕ defined by f(x) = 2x, which property does it satisfy?",
                options: [
                    "One-one but not onto",
                    "Onto but not one-one",
                    "Both one-one and onto",
                    "Neither one-one nor onto"
                ],
                correct: 0,
                explanation: "f(x) = 2x on ℕ is one-one (different inputs give different outputs) but not onto (odd numbers are not in the range)."
            },
            {
                question: "A function f: X → Y is invertible if and only if:",
                options: [
                    "f is one-one only",
                    "f is onto only",
                    "f is both one-one and onto (bijective)",
                    "f is neither one-one nor onto"
                ],
                correct: 2,
                explanation: "A function is invertible if and only if it is bijective (both one-one and onto)."
            },
            {
                question: "If f: A → B and g: B → C, then (gof)(x) equals:",
                options: [
                    "f(g(x))",
                    "g(f(x))",
                    "f(x) + g(x)",
                    "f(x) × g(x)"
                ],
                correct: 1,
                explanation: "Function composition (gof)(x) = g(f(x)) - first apply f, then apply g to the result."
            },
            {
                question: "For finite sets X, if f: X → X is one-one, then f is also:",
                options: [
                    "Not necessarily onto",
                    "Always onto",
                    "Never onto",
                    "Sometimes onto"
                ],
                correct: 1,
                explanation: "For finite sets, a one-one function from X to X must also be onto (this is a key property of finite sets)."
            }
        ];

        // Tab switching
        function showTab(tabName) {
            try {
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                document.getElementById(tabName).classList.add('active');
                event.target.classList.add('active');
                
                currentTab = tabName;
                updateProgress();
            } catch (error) {
                console.error('Error in showTab:', error);
            }
        }

        // Quick demo functions
        function showQuickDemo(type) {
            try {
                const container = document.getElementById('demoFunction');
                const properties = document.getElementById('demoProperties');
                const explanation = document.getElementById('demoExplanation');
                
                let content = '';
                let propContent = '';
                let expContent = '';
                
                switch(type) {
                    case 'oneone':
                        content = createDemoVisualization('oneone');
                        propContent = `
                            <div class="property-indicator true">One-One: ✓</div>
                            <div class="property-indicator false">Onto: ✗</div>
                            <div class="property-indicator false">Bijective: ✗</div>
                        `;
                        expContent = `
                            <h4>One-One Function</h4>
                            <p><strong>Property:</strong> Different inputs → Different outputs</p>
                            <p><strong>Note:</strong> Some codomain elements are not reached</p>
                            <p><strong>Example:</strong> f(1)=a, f(2)=b, f(3)=c</p>
                        `;
                        break;
                        
                    case 'onto':
                        content = createDemoVisualization('onto');
                        propContent = `
                            <div class="property-indicator false">One-One: ✗</div>
                            <div class="property-indicator true">Onto: ✓</div>
                            <div class="property-indicator false">Bijective: ✗</div>
                        `;
                        expContent = `
                            <h4>Onto Function</h4>
                            <p><strong>Property:</strong> Every codomain element is reached</p>
                            <p><strong>Note:</strong> Some outputs have multiple inputs</p>
                            <p><strong>Example:</strong> f(1)=a, f(2)=a, f(3)=b</p>
                        `;
                        break;
                        
                    case 'bijective':
                        content = createDemoVisualization('bijective');
                        propContent = `
                            <div class="property-indicator true">One-One: ✓</div>
                            <div class="property-indicator true">Onto: ✓</div>
                            <div class="property-indicator true">Bijective: ✓</div>
                        `;
                        expContent = `
                            <h4>Bijective Function</h4>
                            <p><strong>Property:</strong> Both one-one and onto</p>
                            <p><strong>Perfect match:</strong> Each input ↔ unique output</p>
                            <p><strong>Special:</strong> Has an inverse function!</p>
                        `;
                        break;
                        
                    case 'manyone':
                        content = createDemoVisualization('manyone');
                        propContent = `
                            <div class="property-indicator false">One-One: ✗</div>
                            <div class="property-indicator false">Onto: ✗</div>
                            <div class="property-indicator false">Bijective: ✗</div>
                        `;
                        expContent = `
                            <h4>Many-One Function</h4>
                            <p><strong>Property:</strong> Multiple inputs → Same output</p>
                            <p><strong>Note:</strong> Not all codomain elements reached</p>
                            <p><strong>Example:</strong> f(1)=a, f(2)=a, f(3)=b</p>
                        `;
                        break;
                }
                
                container.innerHTML = content;
                properties.innerHTML = '<h3>🎯 Function Properties</h3>' + propContent;
                explanation.innerHTML = expContent;
            } catch (error) {
                console.error('Error in showQuickDemo:', error);
            }
        }

        function createDemoVisualization(type) {
            let mappings = {};
            
            switch(type) {
                case 'oneone':
                    mappings = {
                        '1': 'a',
                        '2': 'b', 
                        '3': 'c'
                    };
                    break;
                case 'onto':
                    mappings = {
                        '1': 'a',
                        '2': 'a',
                        '3': 'b',
                        '4': 'c'
                    };
                    break;
                case 'bijective':
                    mappings = {
                        '1': 'a',
                        '2': 'b',
                        '3': 'c'
                    };
                    break;
                case 'manyone':
                    mappings = {
                        '1': 'a',
                        '2': 'a',
                        '3': 'b'
                    };
                    break;
            }
            
            return createFunctionDiagram(mappings, type === 'bijective' ? ['a', 'b', 'c'] : ['a', 'b', 'c', 'd']);
        }

        function createFunctionDiagram(mappings, codomain = ['a', 'b', 'c', 'd']) {
            const domain = Object.keys(mappings);
            
            let html = `
                <div class="set-container domain">
                    <h4 style="text-align: center; margin: 10px; font-size: 0.9em; color: #2c3e50;">Domain</h4>
            `;
            
            domain.forEach((element, index) => {
                html += `<div class="element domain-element" style="top: ${40 + index * 50}px;">${element}</div>`;
            });
            
            html += `
                </div>
                <div class="set-container codomain">
                    <h4 style="text-align: center; margin: 10px; font-size: 0.9em; color: #2c3e50;">Codomain</h4>
            `;
            
            codomain.forEach((element, index) => {
                html += `<div class="element codomain-element" style="top: ${40 + index * 50}px;">${element}</div>`;
            });
            
            html += `</div>`;
            
            // Add SVG for arrows
            html += `<svg style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">`;
            html += `<defs><marker id="demoarerowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" /></marker></defs>`;
            
            Object.entries(mappings).forEach(([from, to]) => {
                const fromIndex = domain.indexOf(from);
                const toIndex = codomain.indexOf(to);
                const fromY = 90 + fromIndex * 50;
                const toY = 90 + toIndex * 50;
                
                html += `<line x1="150" y1="${fromY}" x2="250" y2="${toY}" stroke="#e74c3c" stroke-width="2" marker-end="url(#demoarerowhead)"/>`;
            });
            
            html += `</svg>`;
            
            return html;
        }

        // Function type loader
        function loadFunctionType(type) {
            try {
                const container = document.getElementById('typeVisualization');
                const properties = document.getElementById('typePropertyDisplay');
                const explanation = document.getElementById('typeExplanation');
                
                let mappings, oneone, onto, description;
                
                switch(type) {
                    case 'f1':
                        mappings = {'1': 'a', '2': 'b', '3': 'c', '4': 'd'};
                        oneone = true; onto = false;
                        description = "f₁ is one-one because different domain elements map to different codomain elements. However, it's not onto because elements 'e' and 'f' in the codomain are not mapped to by any domain element.";
                        break;
                    case 'f2':
                        mappings = {'1': 'b', '2': 'b'};
                        oneone = false; onto = false;
                        description = "f₂ is many-one because both '1' and '2' map to the same element 'b'. It's also not onto because many codomain elements are not reached.";
                        break;
                    case 'f3':
                        mappings = {'1': 'a', '2': 'b', '3': 'a', '4': 'c'};
                        oneone = false; onto = true;
                        description = "f₃ is many-one (1 and 3 both map to 'a') but onto because every element in the codomain is mapped to by at least one domain element.";
                        break;
                    case 'f4':
                        mappings = {'1': 'a', '2': 'b', '3': 'c'};
                        oneone = true; onto = true;
                        description = "f₄ is both one-one and onto (bijective). Each domain element maps to a unique codomain element, and every codomain element is reached.";
                        break;
                }
                
                const bijective = oneone && onto;
                
                container.innerHTML = createFunctionDiagram(mappings, type === 'f4' ? ['a', 'b', 'c'] : ['a', 'b', 'c', 'd', 'e', 'f'].slice(0, Math.max(4, Object.keys(mappings).length + 1)));
                
                properties.innerHTML = `
                    <div class="property-indicator ${oneone ? 'true' : 'false'}">One-One: ${oneone ? '✓' : '✗'}</div>
                    <div class="property-indicator ${onto ? 'true' : 'false'}">Onto: ${onto ? '✓' : '✗'}</div>
                    <div class="property-indicator ${bijective ? 'true' : 'false'}">Type: ${bijective ? 'Bijective' : oneone ? 'Injective only' : onto ? 'Surjective only' : 'Neither'}</div>
                `;
                
                explanation.innerHTML = `
                    <h4>Function ${type.toUpperCase()} Analysis</h4>
                    <p>${description}</p>
                    <p><strong>Mapping:</strong> ${Object.entries(mappings).map(([k,v]) => `${k}→${v}`).join(', ')}</p>
                `;
            } catch (error) {
                console.error('Error in loadFunctionType:', error);
            }
        }

        // Composition functions
        function loadCompositionExample(example) {
            try {
                const functionF = document.getElementById('functionF');
                const functionG = document.getElementById('functionG');
                const compositionResult = document.getElementById('compositionResult');
                const visualization = document.getElementById('compositionVisualization');
                
                if (!functionF || !functionG || !compositionResult || !visualization) return;
                
                switch(example) {
                    case 'example15':
                        functionF.innerHTML = `
                            f: {2,3,4,5} → {3,4,5,9}<br>
                            f(2)=3, f(3)=4, f(4)=f(5)=5
                        `;
                        functionG.innerHTML = `
                            g: {3,4,5,9} → {7,11,15}<br>
                            g(3)=g(4)=7, g(5)=g(9)=11
                        `;
                        compositionResult.innerHTML = `
                            gof: {2,3,4,5} → {7,11,15}<br>
                            gof(2)=7, gof(3)=7, gof(4)=gof(5)=11
                        `;
                        break;
                        
                    case 'example16':
                        functionF.innerHTML = `
                            f: ℝ → ℝ<br>
                            f(x) = cos x
                        `;
                        functionG.innerHTML = `
                            g: ℝ → ℝ<br>
                            g(x) = 3x²
                        `;
                        compositionResult.innerHTML = `
                            gof: ℝ → ℝ<br>
                            (gof)(x) = 3cos²x<br>
                            fog: ℝ → ℝ<br>
                            (fog)(x) = cos(3x²)
                        `;
                        break;
                }
                
                visualization.innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h3>${example === 'example15' ? 'Discrete Function Composition' : 'Continuous Function Composition'}</h3>
                        <div style="font-size: 1.2em; margin: 20px 0; color: #2c3e50;">
                            ${example === 'example15' ? 
                                'Step-by-step: gof(2) = g(f(2)) = g(3) = 7' : 
                                'gof(x) = g(f(x)) = g(cos x) = 3(cos x)² = 3cos²x'
                            }
                        </div>
                        <div style="background: #e8f4f8; padding: 15px; border-radius: 10px; margin: 20px 0;">
                            <strong>Note:</strong> ${example === 'example16' ? 'gof ≠ fog in general!' : 'Function composition follows specific mapping rules'}
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('Error in loadCompositionExample:', error);
            }
        }

        function createCustomComposition() {
            try {
                const functionF = document.getElementById('functionF');
                const functionG = document.getElementById('functionG');
                const compositionResult = document.getElementById('compositionResult');
                const visualization = document.getElementById('compositionVisualization');
                
                if (!functionF || !functionG || !compositionResult || !visualization) return;
                
                functionF.innerHTML = `
                    Custom f: A → B<br>
                    f(x) = x + 1
                `;
                functionG.innerHTML = `
                    Custom g: B → C<br>
                    g(y) = 2y
                `;
                compositionResult.innerHTML = `
                    gof: A → C<br>
                    (gof)(x) = g(f(x)) = g(x+1) = 2(x+1) = 2x+2
                `;
                
                visualization.innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h3>🛠️ Custom Function Composition</h3>
                        <div style="font-size: 1.2em; margin: 20px 0; color: #2c3e50;">
                            (gof)(x) = g(f(x)) = g(x+1) = 2(x+1) = 2x+2
                        </div>
                        <div style="background: #e8f8e8; padding: 15px; border-radius: 10px; margin: 20px 0;">
                            <strong>Example:</strong> If x = 3, then (gof)(3) = 2(3)+2 = 8
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('Error in createCustomComposition:', error);
            }
        }

        function showCompositionSteps() {
            try {
                const steps = document.getElementById('compositionSteps');
                const stepsList = document.getElementById('stepsList');
                
                if (!steps || !stepsList) return;
                
                stepsList.innerHTML = `
                    <div class="step-indicator">
                        <strong>Step 1:</strong> Apply function f to the input: f(x)
                    </div>
                    <div class="step-indicator">
                        <strong>Step 2:</strong> Take the result and apply function g: g(f(x))
                    </div>
                    <div class="step-indicator">
                        <strong>Step 3:</strong> The composition gof(x) = g(f(x))
                    </div>
                    <div class="step-indicator">
                        <strong>Important:</strong> Order matters! gof ≠ fog in general
                    </div>
                `;
                
                steps.style.display = steps.style.display === 'none' ? 'block' : 'none';
            } catch (error) {
                console.error('Error in showCompositionSteps:', error);
            }
        }

        // Inverse function examples
        function loadInverseExample(example) {
            try {
                const visualization = document.getElementById('inverseVisualization');
                const properties = document.getElementById('inverseStatus');
                const details = document.getElementById('inverseDetails');
                
                if (!visualization || !properties || !details) return;
                
                switch(example) {
                    case 'linear':
                        visualization.innerHTML = `
                            <div style="text-align: center; padding: 40px;">
                                <h3>Linear Function: f(x) = 2x + 3</h3>
                                <div style="margin: 20px 0;">
                                    <div style="background: #e8f4f8; padding: 15px; border-radius: 10px; margin: 10px 0;">
                                        <strong>Function:</strong> f: ℝ → ℝ, f(x) = 2x + 3
                                    </div>
                                    <div style="background: #e8f8e8; padding: 15px; border-radius: 10px; margin: 10px 0;">
                                        <strong>Inverse:</strong> f⁻¹: ℝ → ℝ, f⁻¹(x) = (x-3)/2
                                    </div>
                                </div>
                                <div style="font-size: 0.9em; color: #666;">
                                    Verification: f(f⁻¹(x)) = f((x-3)/2) = 2((x-3)/2) + 3 = x ✓
                                </div>
                            </div>
                        `;
                        properties.innerHTML = `
                            <div class="property-indicator true">Invertible: ✓</div>
                            <div class="property-indicator true">One-One: ✓</div>
                            <div class="property-indicator true">Onto: ✓</div>
                        `;
                        details.innerHTML = `
                            <h4>Linear Function Inverse</h4>
                            <p><strong>Method:</strong> Solve y = 2x + 3 for x to get x = (y-3)/2</p>
                            <p><strong>Result:</strong> f⁻¹(x) = (x-3)/2</p>
                            <p><strong>Check:</strong> f(f⁻¹(x)) = x and f⁻¹(f(x)) = x ✓</p>
                        `;
                        break;
                        
                    case 'quadratic':
                        visualization.innerHTML = `
                            <div style="text-align: center; padding: 40px;">
                                <h3>Quadratic Function: f(x) = x²</h3>
                                <div style="margin: 20px 0;">
                                    <div style="background: #ffe8e8; padding: 15px; border-radius: 10px;">
                                        <strong>Problem:</strong> f(-1) = f(1) = 1
                                    </div>
                                </div>
                                <div style="font-size: 0.9em; color: #666;">
                                    Not one-one → No inverse exists!
                                </div>
                            </div>
                        `;
                        properties.innerHTML = `
                            <div class="property-indicator false">Invertible: ✗</div>
                            <div class="property-indicator false">One-One: ✗</div>
                            <div class="property-indicator false">Onto: ✗</div>
                        `;
                        details.innerHTML = `
                            <h4>Quadratic Function Analysis</h4>
                            <p><strong>Issue:</strong> f(x) = x² is not one-one because f(-1) = f(1) = 1</p>
                            <p><strong>Also:</strong> Not onto because negative numbers are not in range</p>
                            <p><strong>Solution:</strong> Restrict domain to [0,∞) to make it invertible</p>
                        `;
                        break;
                        
                    case 'example17':
                        visualization.innerHTML = `
                            <div style="text-align: center; padding: 40px;">
                                <h3>Example 17: f(x) = 4x + 3</h3>
                                <div style="margin: 20px 0;">
                                    <div style="background: #e8f4f8; padding: 15px; border-radius: 10px; margin: 10px 0;">
                                        <strong>Domain:</strong> ℕ
                                    </div>
                                    <div style="background: #e8f8e8; padding: 15px; border-radius: 10px; margin: 10px 0;">
                                        <strong>Codomain:</strong> Y = {y ∈ ℕ : y = 4x + 3 for some x ∈ ℕ}
                                    </div>
                                    <div style="background: #fff3e0; padding: 15px; border-radius: 10px; margin: 10px 0;">
                                        <strong>Inverse:</strong> f⁻¹(y) = (y-3)/4
                                    </div>
                                </div>
                            </div>
                        `;
                        properties.innerHTML = `
                            <div class="property-indicator true">Invertible: ✓</div>
                            <div class="property-indicator true">One-One: ✓</div>
                            <div class="property-indicator true">Onto: ✓</div>
                        `;
                        details.innerHTML = `
                            <h4>Textbook Example 17</h4>
                            <p><strong>Key insight:</strong> Codomain is carefully chosen to make function onto</p>
                            <p><strong>Inverse:</strong> g(y) = (y-3)/4</p>
                            <p><strong>Verification:</strong> gof = I_ℕ and fog = I_Y</p>
                        `;
                        break;
                }
            } catch (error) {
                console.error('Error in loadInverseExample:', error);
            }
        }

        function testInverse() {
            try {
                const details = document.getElementById('inverseDetails');
                if (!details) return;
                
                details.innerHTML = `
                    <h4>🧪 Inverse Function Test</h4>
                    <div style="background: #e8f4f8; padding: 15px; border-radius: 10px; margin: 10px 0;">
                        <strong>Test Function:</strong> f(x) = 3x - 1
                    </div>
                    <div style="background: #e8f8e8; padding: 15px; border-radius: 10px; margin: 10px 0;">
                        <strong>Proposed Inverse:</strong> g(x) = (x+1)/3
                    </div>
                    <div style="background: #fff3e0; padding: 15px; border-radius: 10px; margin: 10px 0;">
                        <strong>Verification:</strong><br>
                        • f(g(x)) = f((x+1)/3) = 3((x+1)/3) - 1 = x + 1 - 1 = x ✓<br>
                        • g(f(x)) = g(3x-1) = ((3x-1)+1)/3 = 3x/3 = x ✓
                    </div>
                    <p><strong>Result:</strong> The inverse is correct! ✅</p>
                `;
            } catch (error) {
                console.error('Error in testInverse:', error);
            }
        }

        // Textbook examples
        function loadTextbookExample(example) {
            try {
                const visualization = document.getElementById('exampleVisualization');
                const analysis = document.getElementById('exampleSteps');
                
                if (!visualization || !analysis) return;
                
                switch(example) {
                    case 'example7':
                        visualization.innerHTML = `
                            <div style="text-align: center; padding: 40px;">
                                <h3>👥 Student Roll Numbers</h3>
                                <div style="margin: 20px 0;">
                                    <div style="background: #e8f4f8; padding: 15px; border-radius: 10px;">
                                        <strong>Function:</strong> f: A → ℕ<br>
                                        A = set of 50 students<br>
                                        f(student) = roll number
                                    </div>
                                </div>
                            </div>
                        `;
                        analysis.innerHTML = `
                            <div class="step-indicator">
                                <strong>One-One Analysis:</strong> No two students can have the same roll number ✓
                            </div>
                            <div class="step-indicator">
                                <strong>Onto Analysis:</strong> Numbers like 51, 52, ... are not roll numbers of any student ✗
                            </div>
                            <div class="step-indicator">
                                <strong>Conclusion:</strong> Function is one-one but not onto
                            </div>
                        `;
                        break;
                        
                    case 'example8':
                        visualization.innerHTML = `
                            <div style="text-align: center; padding: 40px;">
                                <h3>🔢 f(x) = 2x on ℕ</h3>
                                <div style="margin: 20px 0;">
                                    <div style="background: #e8f4f8; padding: 15px; border-radius: 10px;">
                                        <strong>Function:</strong> f: ℕ → ℕ, f(x) = 2x<br>
                                        Maps: 1→2, 2→4, 3→6, 4→8, ...
                                    </div>
                                </div>
                            </div>
                        `;
                        analysis.innerHTML = `
                            <div class="step-indicator">
                                <strong>One-One:</strong> If f(x₁) = f(x₂), then 2x₁ = 2x₂ ⟹ x₁ = x₂ ✓
                            </div>
                            <div class="step-indicator">
                                <strong>Onto:</strong> Odd numbers like 1, 3, 5 are not in range ✗
                            </div>
                            <div class="step-indicator">
                                <strong>Conclusion:</strong> One-one but not onto
                            </div>
                        `;
                        break;
                        
                    case 'example9':
                        visualization.innerHTML = `
                            <div style="text-align: center; padding: 40px;">
                                <h3>📈 f(x) = 2x on ℝ</h3>
                                <div style="margin: 20px 0;">
                                    <div style="background: #e8f8e8; padding: 15px; border-radius: 10px;">
                                        <strong>Function:</strong> f: ℝ → ℝ, f(x) = 2x<br>
                                        For any y ∈ ℝ, x = y/2 exists in ℝ
                                    </div>
                                </div>
                            </div>
                        `;
                        analysis.innerHTML = `
                            <div class="step-indicator">
                                <strong>One-One:</strong> If f(x₁) = f(x₂), then 2x₁ = 2x₂ ⟹ x₁ = x₂ ✓
                            </div>
                            <div class="step-indicator">
                                <strong>Onto:</strong> For any y ∈ ℝ, choose x = y/2, then f(y/2) = y ✓
                            </div>
                            <div class="step-indicator">
                                <strong>Conclusion:</strong> Bijective function! Has an inverse: f⁻¹(x) = x/2
                            </div>
                        `;
                        break;
                        
                    case 'example11':
                        visualization.innerHTML = `
                            <div style="text-align: center; padding: 40px;">
                                <h3>📊 f(x) = x²</h3>
                                <div style="margin: 20px 0;">
                                    <div style="background: #ffe8e8; padding: 15px; border-radius: 10px;">
                                        <strong>Function:</strong> f: ℝ → ℝ, f(x) = x²<br>
                                        Problem: f(-1) = f(1) = 1
                                    </div>
                                </div>
                            </div>
                        `;
                        analysis.innerHTML = `
                            <div class="step-indicator">
                                <strong>One-One:</strong> f(-1) = 1 = f(1), but -1 ≠ 1 ✗
                            </div>
                            <div class="step-indicator">
                                <strong>Onto:</strong> -2 ∈ ℝ but no x exists such that x² = -2 ✗
                            </div>
                            <div class="step-indicator">
                                <strong>Conclusion:</strong> Neither one-one nor onto
                            </div>
                        `;
                        break;
                }
            } catch (error) {
                console.error('Error in loadTextbookExample:', error);
            }
        }

        // Quiz functions
        function startQuiz() {
            try {
                currentQuizQuestion = 0;
                quizAnswers = new Array(quizQuestions.length).fill(null);
                quizStarted = true;
                
                document.getElementById('prevBtn').style.display = 'inline-block';
                document.getElementById('nextBtn').style.display = 'inline-block';
                const quizResults = document.getElementById('quizResults');
                if (quizResults) {
                    quizResults.style.display = 'none';
                }
                
                showQuizQuestion();
                updateQuizProgress();
            } catch (error) {
                console.error('Error in startQuiz:', error);
            }
        }

        function showQuizQuestion() {
            try {
                const container = document.getElementById('quizContainer');
                if (!container || !quizQuestions[currentQuizQuestion]) return;
                
                const question = quizQuestions[currentQuizQuestion];
                
                container.innerHTML = `
                    <div class="question">
                        Question ${currentQuizQuestion + 1} of ${quizQuestions.length}: ${question.question}
                    </div>
                    <div class="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectQuizAnswer(${index})" data-index="${index}">
                                ${String.fromCharCode(65 + index)}. ${option}
                            </div>
                        `).join('')}
                    </div>
                    <div id="explanation" style="display: none; background: #e8f4f8; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>💡 Explanation:</strong> ${question.explanation}
                    </div>
                `;
                
                if (quizAnswers[currentQuizQuestion] !== null) {
                    const selectedOption = container.querySelector(`[data-index="${quizAnswers[currentQuizQuestion]}"]`);
                    if (selectedOption) {
                        selectedOption.classList.add('selected');
                        const explanation = document.getElementById('explanation');
                        if (explanation) {
                            explanation.style.display = 'block';
                        }
                    }
                }
                
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                const submitBtn = document.getElementById('submitBtn');
                
                if (prevBtn) prevBtn.disabled = currentQuizQuestion === 0;
                if (nextBtn) nextBtn.style.display = currentQuizQuestion === quizQuestions.length - 1 ? 'none' : 'inline-block';
                if (submitBtn) submitBtn.style.display = currentQuizQuestion === quizQuestions.length - 1 ? 'inline-block' : 'none';
            } catch (error) {
                console.error('Error in showQuizQuestion:', error);
            }
        }

        function selectQuizAnswer(answerIndex) {
            try {
                document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                
                const selectedOption = document.querySelector(`[data-index="${answerIndex}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                    quizAnswers[currentQuizQuestion] = answerIndex;
                    const explanation = document.getElementById('explanation');
                    if (explanation) {
                        explanation.style.display = 'block';
                    }
                }
            } catch (error) {
                console.error('Error in selectQuizAnswer:', error);
            }
        }

        function nextQuestion() {
            try {
                if (currentQuizQuestion < quizQuestions.length - 1) {
                    currentQuizQuestion++;
                    showQuizQuestion();
                    updateQuizProgress();
                }
            } catch (error) {
                console.error('Error in nextQuestion:', error);
            }
        }

        function previousQuestion() {
            try {
                if (currentQuizQuestion > 0) {
                    currentQuizQuestion--;
                    showQuizQuestion();
                    updateQuizProgress();
                }
            } catch (error) {
                console.error('Error in previousQuestion:', error);
            }
        }

        function submitQuiz() {
            try {
                let correctAnswers = 0;
                quizAnswers.forEach((answer, index) => {
                    if (answer === quizQuestions[index].correct) {
                        correctAnswers++;
                    }
                });
                
                const percentage = Math.round((correctAnswers / quizQuestions.length) * 100);
                const resultsContainer = document.getElementById('quizResults');
                
                if (!resultsContainer) return;
                
                let message = '';
                let color = '';
                
                if (percentage >= 80) {
                    message = 'Excellent! You have mastered function types! 🎉';
                    color = '#27ae60';
                } else if (percentage >= 60) {
                    message = 'Good job! Review function properties once more. 👍';
                    color = '#f39c12';
                } else {
                    message = 'Keep studying! Practice more with the examples. 💪';
                    color = '#e74c3c';
                }
                
                resultsContainer.innerHTML = `
                    <h3 style="color: ${color};">🎯 Quiz Results</h3>
                    <div style="font-size: 1.5em; margin: 20px 0;">
                        Score: ${correctAnswers}/${quizQuestions.length} (${percentage}%)
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                        ${message}
                    </div>
                    <button class="btn" onclick="startQuiz()" style="margin-top: 15px;">🔄 Retake Quiz</button>
                `;
                
                resultsContainer.style.display = 'block';
                
                const quizContainer = document.getElementById('quizContainer');
                const controls = document.querySelector('#quiz .controls');
                
                if (quizContainer) quizContainer.style.display = 'none';
                if (controls) controls.style.display = 'none';
            } catch (error) {
                console.error('Error in submitQuiz:', error);
            }
        }

        function updateQuizProgress() {
            try {
                const progress = ((currentQuizQuestion + 1) / quizQuestions.length) * 100;
                const progressBar = document.getElementById('quizProgress');
                if (progressBar) {
                    progressBar.style.width = progress + '%';
                }
            } catch (error) {
                console.error('Error in updateQuizProgress:', error);
            }
        }

        function updateProgress() {
            try {
                const tabs = ['intro', 'types', 'composition', 'inverse', 'examples', 'quiz'];
                const currentIndex = tabs.indexOf(currentTab);
                const progress = ((currentIndex + 1) / tabs.length) * 100;
                const progressBar = document.getElementById('overallProgress');
                if (progressBar) {
                    progressBar.style.width = progress + '%';
                }
            } catch (error) {
                console.error('Error in updateProgress:', error);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('🔢 Initializing Functions Interactive Tool...');
                updateProgress();
                console.log('✅ Functions tool initialized successfully!');
            } catch (error) {
                console.error('Error during initialization:', error);
            }
        });

        // Global error handler
        window.addEventListener('error', function(event) {
            console.error('Global error caught:', event.error);
        });
    </script>
</body>
</html>
